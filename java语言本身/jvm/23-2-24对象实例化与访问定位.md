# 创建对象的几种方法
* new关键字
* Class的newInstance()：反射方式，只能调用空参构造器，修饰符必须是public
* Constructor的newInstance()：反射方式，没有要求
* clone()需要实现Cloneable接口
* 使用反序列化
# 创建对象的步骤
1. 判断对象对应的类是否加载、链接、初始化
2. 为对象分配内存
    * 如果内存规整 指针碰撞法
    * 如果内存不规整 根据内存空闲表分配内存
3. 处理并发安全问题
    * 采用CAS失败重试、区域加锁保证更新的原子性
    * 每个线程预先分配TLAB(总共占伊甸园区的百分之一)
4. 初始化分配到的空间，即给对象属性设置默认值
5. 设置对象的对象头
6. 执行init方法进行初始化(这一步才调用类的构造器对应的方法) 
# 对象的内存结构
 ![avatar](../对象的内存布局.png) 
## 对象头
 * 运行时元数据
    * 哈希值 根据对象的地址计算的哈希
    * GC分代年龄
    * 锁状态标志
    * 线程持有的锁
    * 偏向线程的ID
    * 偏向时间戳
 * 类型指针（指向元空间）执行类元数据InstanceClass，确定对象所属的类型
 * 实例数据（真正存储对象的属性值）
   * 父类的变量出现在子类之前
   * 如果CompactFields参数为true， 子类的摘编量可能插入到父类变量的间隙
 * 对齐填充 HotSpot VM要求对象的起始位置必须是8字节的整数倍，也就是说对象必须是8字节的整数倍，所以需要填充占位

# 对象的访问定位
* 句柄访问
![avatar](../句柄访问.png)
* 直接访问(HotSpot所采用的)
![avatar](../直接访问.png) 
